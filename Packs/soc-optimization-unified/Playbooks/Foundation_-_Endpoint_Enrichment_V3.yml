fromversion: 5.0.0
id: Foundation - Endpoint Enrichment_V3
version: 43
contentitemexportablefields:
  contentitemfields:
    packID: soc-optimization-unified
    packName: SOC Framework Unified
    itemVersion: 3.0.30
    fromServerVersion: 5.0.0
    toServerVersion: ""
    definitionid: ""
    fromServerVersion: 5.0.0
    isoverridable: false
    itemVersion: 3.0.29
    packID: ""
    packName: SOC Framework Unified
    prevname: ""
    supportedModules: []
    toServerVersion: ""
description: |
  Identifies the core fields present and starts tailored enrichment pipelines
  Generates threat flags based on findings (ex: if we identify a domain controller or admin account)
dirtyInputs: true
id: 'Foundation - Endpoint Enrichment_V3'
inputSections:
- description: Generic group for inputs
  inputs:
  - SourceIP
  - RemoteIP
  - UserName
  - EndpointID
  - HostName
  - Domain
  - MD5
  - SHA256
  - PID
  - ProcessName
  name: General (Inputs group)
inputs:
- description: ""
  key: SourceIP
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.hostip}
- description: ""
  key: RemoteIP
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.remoteip}
- description: ""
  key: UserName
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.username}
- description: ""
  key: EndpointID
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.agentid}
- description: ""
  key: HostName
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.hostname}
- description: ""
  key: Domain
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.domain}
- description: ""
  key: MD5
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.initiatormd5}
- description: ""
  key: SHA256
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.initiatorsha256}
- description: ""
  key: PID
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.initiatorpid}
- description: ""
  key: ProcessName
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.xdmsourceprocessname}
name: Foundation - Endpoint Enrichment_V3
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - SOCFramework.Artifacts.IP
  - SOCFramework.Artifacts.EndPointID
  - SOCFramework.Artifacts.UserName
  - SOCFramework.Artifacts.ProcessName
  - SOCFramework.Artifacts.File
  - SOCFramework.Artifacts.Verdict
outputs:
- contextPath: SOCFramework.Artifacts.IP
  type: unknown
- contextPath: SOCFramework.Artifacts.EndPointID
  type: unknown
- contextPath: SOCFramework.Artifacts.UserName
  type: unknown
- contextPath: SOCFramework.Artifacts.ProcessName
  type: unknown
- contextPath: SOCFramework.Artifacts.File
  type: unknown
- contextPath: SOCFramework.Artifacts.Verdict
  type: unknown
sourceplaybookid: Foundation - Enrichment_V3
starttaskid: "0"
tags:
- SOC
- SOC_Framework_Unified
- Enrichment
- EndPoint
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8492b25a-a19c-4593-8191-9cb60e4d3007
      iscommand: false
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#none#':
      - "9"
      - "18"
      - "22"
      - "19"
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 930,
          "y": 50
        }
      }
  "2":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.SourceIP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "2"
    taskid: 492f9a4d-166a-498e-9c6e-dfb786911560
    type: condition
    task:
      id: 492f9a4d-166a-498e-9c6e-dfb786911560
      version: -1
      name: Is Source IP Defined?
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 492f9a4d-166a-498e-9c6e-dfb786911560
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Is Source IP Defined?
      playbooktaskmissingcomponent: null
      type: condition
      version: -1
    taskid: 492f9a4d-166a-498e-9c6e-dfb786911560
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 390
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6b3dbf1c-9a22-4bd4-8593-bc8d49dcc7c0
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Done
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 6b3dbf1c-9a22-4bd4-8593-bc8d49dcc7c0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 715,
          "y": 1315
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.RemoteIP
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "5"
    taskid: 7dba9f04-0e82-4fdd-9185-3ca038f978e6
    type: condition
    task:
      id: 7dba9f04-0e82-4fdd-9185-3ca038f978e6
      version: -1
      name: Is Destination IP Defined?
      type: condition
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#default#':
      - "4"
      "yes":
      - "11"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7dba9f04-0e82-4fdd-9185-3ca038f978e6
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Is Destination IP Defined?
      playbooktaskmissingcomponent: null
      type: condition
      version: -1
    taskid: 7dba9f04-0e82-4fdd-9185-3ca038f978e6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 760
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 7402ac5c-de53-492c-a7fa-ec826ef30adf
    type: regular
    task:
      id: 7402ac5c-de53-492c-a7fa-ec826ef30adf
      version: -1
      name: Enrich Source IP
      description: Provides data enrichment for ips.
      script: '|||ip'
      type: regular
      iscommand: true
      brand: ""
      id: 02dc9df5-d1cf-4475-83a6-dc33e09fc4fe
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: IP Enrichment
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 02dc9df5-d1cf-4475-83a6-dc33e09fc4fe
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 190,
          "y": 40
        }
      }
  "10":
    continueonerror: true
    continueonerrortype: errorPath
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "16"
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${inputs.SourceIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provides data enrichment for ips.
      id: 7402ac5c-de53-492c-a7fa-ec826ef30adf
      iscommand: true
      istaskmissingcomponenterrordismissed: false
      name: Enrich Source IP
      playbooktaskmissingcomponent: null
      script: '|||ip'
      type: regular
      version: -1
    taskid: 7402ac5c-de53-492c-a7fa-ec826ef30adf
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 575
        }
      }
  "11":
    continueonerror: true
    continueonerrortype: errorPath
    id: "11"
    taskid: ef34ca76-959d-4677-aaf2-bd88f9cfc4e6
    type: regular
    task:
      id: ef34ca76-959d-4677-aaf2-bd88f9cfc4e6
      version: -1
      name: Enrich Destination IP
      description: Provides data enrichment for ips.
      script: '|||ip'
      type: regular
      iscommand: true
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    nexttasks:
      '#error#':
      - "16"
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        simple: ${inputs.RemoteIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provides data enrichment for ips.
      id: ef34ca76-959d-4677-aaf2-bd88f9cfc4e6
      iscommand: true
      istaskmissingcomponenterrordismissed: false
      name: Enrich Destination IP
      playbooktaskmissingcomponent: null
      script: '|||ip'
      type: regular
      version: -1
    taskid: ef34ca76-959d-4677-aaf2-bd88f9cfc4e6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 945
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 35dec624-d2e2-448e-a49c-62dc66589b2e
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Foundation - Error Handling_V3
      playbookId: Foundation - Error Handling_V3
      playbooktaskmissingcomponent: null
      type: playbook
      version: -1
    taskid: 35dec624-d2e2-448e-a49c-62dc66589b2e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 397.5,
          "y": 1130
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7654576b-eded-482f-bec2-270055ebde0c
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: User Enrichment
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 7654576b-eded-482f-bec2-270055ebde0c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1360,
          "y": 952.5
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 38b6a1fa-dc59-43ae-8091-ff4c66c459be
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: File Enrichment
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 38b6a1fa-dc59-43ae-8091-ff4c66c459be
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 952.5
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e7de422-55dc-4dfd-b67f-d5c6a7d9570d
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: EndPoint Enrichment
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 1e7de422-55dc-4dfd-b67f-d5c6a7d9570d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 930,
          "y": 952.5
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    taskid: 1191bbbd-a098-4503-9af2-d44af45477e7
    type: playbook
    task:
      id: 1191bbbd-a098-4503-9af2-d44af45477e7
      version: -1
      name: SOC File Enrichment - File reputation_V3
      description: Get file reputation using one or more integrations
      playbookName: SOC File Enrichment - File reputation_V3
      type: playbook
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      MD5:
        simple: ${inputs.MD5}
      SHA1:
        simple: ${inputs.SHA1}
      SHA256:
        simple: ${inputs.SHA256}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Get file reputation using one or more integrations
      id: 1191bbbd-a098-4503-9af2-d44af45477e7
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: SOC File Enrichment - File reputation_V3
      playbookId: SOC File Enrichment - File reputation_V3
      playbooktaskmissingcomponent: null
      type: playbook
      version: -1
    taskid: 1191bbbd-a098-4503-9af2-d44af45477e7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1790,
          "y": 1130
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    taskid: 7a660f68-880d-408d-9d36-b6c05eb14776
    type: playbook
    task:
      id: 7a660f68-880d-408d-9d36-b6c05eb14776
      version: -1
      name: SOC Endpoint Enrichment - Generic v2.1_V3
      description: |-
        Enrich an endpoint by hostname using one or more integrations.
        Supported integrations:
        - Active Directory Query v2
        - McAfee ePO v2
        - VMware Carbon Black EDR v2
        - Cylance Protect v2
        - CrowdStrike Falcon
        - ExtraHop Reveal(x)
        - Cortex XDR / Core (endpoint enrichment, reputation and risk)
        - Endpoint reputation using !endpoint command.
      playbookName: SOC Endpoint Enrichment - Generic v2.1_V3
      type: playbook
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      EndpointID:
        complex:
          root: inputs.EndpointID
          transformers:
          - operator: uniq
      Hostname:
        complex:
          root: inputs.HostName
          transformers:
          - operator: uniq
      IPAddress:
        complex:
          root: inputs.SourceIP
          transformers:
          - operator: uniq
      UseReputationCommand:
        simple: "False"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Enrich an endpoint by hostname using one or more integrations.
        Supported integrations:
        - Active Directory Query v2
        - McAfee ePO v2
        - VMware Carbon Black EDR v2
        - Cylance Protect v2
        - CrowdStrike Falcon
        - ExtraHop Reveal(x)
        - Cortex XDR / Core (endpoint enrichment, reputation and risk)
        - Endpoint reputation using !endpoint command.
      id: 7a660f68-880d-408d-9d36-b6c05eb14776
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: SOC Endpoint Enrichment - Generic v2.1_V3
      playbookId: SOC Endpoint Enrichment - Generic v2.1_V3
      playbooktaskmissingcomponent: null
      type: playbook
      version: -1
    taskid: 7a660f68-880d-408d-9d36-b6c05eb14776
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1130
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    taskid: 7a727f50-0c00-4d67-a958-da0fc9ea4627
    type: playbook
    task:
      id: 7a727f50-0c00-4d67-a958-da0fc9ea4627
      version: -1
      name: SOC Account Enrichment - Generic v2.1_V3
      description: |-
        Enrich accounts using one or more integrations.
        Supported integrations:
        - Active Directory
        - Microsoft Graph User
        - SailPoint IdentityNow
        - SailPoint IdentityIQ
        - PingOne
        - Okta
        - AWS IAM
        - Cortex XDR (account enrichment and reputation)

        Also, the playbook supports the generic command 'iam-get-user' (implemented in IAM integrations). For more information, visit https://xsoar.pan.dev/docs/integrations/iam-integrations.
      id: 7a727f50-0c00-4d67-a958-da0fc9ea4627
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: SOC Account Enrichment - Generic v2.1_V3
      playbookId: SOC Account Enrichment - Generic v2.1_V3
      playbooktaskmissingcomponent: null
      type: playbook
      version: -1
    taskid: 7a727f50-0c00-4d67-a958-da0fc9ea4627
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 827.5,
          "y": 1110
        }
      }
  "28":
    continueonerror: true
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.ProcessName
      value:
        simple: ${issue.xdmsourceprocessname}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: bef489c3-a84d-4165-bd1d-962459b13b2e
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Process Name SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: bef489c3-a84d-4165-bd1d-962459b13b2e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 825
        }
      }
  "29":
    continueonerror: true
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.File
      value:
        simple: ${inputs.SHA256}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 7f37bc21-a7aa-402b-bc75-f563fb6d649c
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set File SHA256 SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 7f37bc21-a7aa-402b-bc75-f563fb6d649c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 960
        }
      }
  "30":
    continueonerror: true
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
      - "22"
      - "18"
      - "9"
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.EndPointID
      value:
        simple: ${inputs.EndpointID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: de9aeb7d-0a29-4116-95d9-5b7f39ab52f8
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set EndPoint ID SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: de9aeb7d-0a29-4116-95d9-5b7f39ab52f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1050,
          "y": -120
        }
      }
  "31":
    continueonerror: true
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.Verdict
      value:
        complex:
          accessor: Verdict
          filters:
          - - left:
                iscontext: true
                value:
                  simple: Unit42Intelligence.File.Value
              operator: in
              right:
                iscontext: true
                value:
                  simple: inputs.SHA256
          root: Unit42Intelligence.File
          transformers:
          - operator: StringToArray
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: b9da1344-05bb-40c9-82af-65506a6aad43
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Unit 42 File Verdict Name SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b9da1344-05bb-40c9-82af-65506a6aad43
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 1230
        }
      }
  "32":
    continueonerror: true
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: SOCFramework.Artifacts.UserName
      value:
        simple: ${inputs.UserName}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: c9f5968e-f194-4768-867a-ba1c6b234989
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Process Name SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: c9f5968e-f194-4768-867a-ba1c6b234989
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1360,
          "y": 1130
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: c990cbe2-c1cd-45fe-b3d9-e138e446e074
    type: title
    task:
      id: c990cbe2-c1cd-45fe-b3d9-e138e446e074
      version: -1
      name: Process Enrichment
      type: title
      iscommand: false
      brand: ""
      playbooktaskmissingcomponent: null
      istaskmissingcomponenterrordismissed: false
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 705,
          "y": 220
        }
      }
  "33":
    continueonerror: true
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.IP
      value:
        simple: ${inputs.SourceIP}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 413a9a1b-01eb-43bb-96b1-b2cc830851b0
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set IP SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 413a9a1b-01eb-43bb-96b1-b2cc830851b0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 200
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c990cbe2-c1cd-45fe-b3d9-e138e446e074
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Process Enrichment
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: c990cbe2-c1cd-45fe-b3d9-e138e446e074
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 530
        }
      }
  "35":
    continueonerror: true
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.ProcessName
      value:
        simple: ${inputs.ProcessName}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 92db05bd-9e78-43ac-b88a-eac0fcd566ed
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Process Name SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 92db05bd-9e78-43ac-b88a-eac0fcd566ed
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 840
        }
      }
  "36":
    continueonerror: true
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.PID
      value:
        simple: ${inputs.PID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 966d8fc9-1c14-46a6-a320-fdfc15141a25
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Process ID SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 966d8fc9-1c14-46a6-a320-fdfc15141a25
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 1020
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ccb68bea-4961-4bfc-98fd-ff7608a7eb92
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: No Enrichment
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: ccb68bea-4961-4bfc-98fd-ff7608a7eb92
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 1190
        }
      }
  "38":
    continueonerror: true
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.HostName
      value:
        simple: ${inputs.HostName}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 4205da3b-ac89-47c0-b432-fe7300ce01c1
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set HostName SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 4205da3b-ac89-47c0-b432-fe7300ce01c1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1050,
          "y": -240
        }
      }
  "39":
    continueonerror: true
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.FilePath
      value:
        simple: ${issue.initiatorpath}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 943d5886-2046-4245-a73a-bc522568fe08
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set File Path SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 943d5886-2046-4245-a73a-bc522568fe08
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 690
        }
      }
  "40":
    continueonerror: true
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: SOCFramework.Artifacts.FilePath
      value:
        simple: ${issue.initiatorpath}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: dffd68e4-3122-473d-97ac-586715742234
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set File Path SOCFramework Artifact
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: dffd68e4-3122-473d-97ac-586715742234
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2360,
          "y": 675
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 1325,
        "width": 2120,
        "x": 50,
        "y": -340
      }
    }
  }
inputs:
- key: SourceIP
  value:
    simple: ${issue.hostip}
  required: false
  description: ""
  playbookInputQuery: null
- key: RemoteIP
  value:
    simple: ${issue.remoteip}
  required: false
  description: ""
  playbookInputQuery: null
- key: UserName
  value:
    simple: ${issue.username}
  required: false
  description: ""
  playbookInputQuery: null
- key: EndpointID
  value:
    simple: ${issue.agentid}
  required: false
  description: ""
  playbookInputQuery: null
- key: HostName
  value:
    simple: ${issue.hostname}
  required: false
  description: ""
  playbookInputQuery: null
- key: Domain
  value:
    simple: ${issue.domain}
  required: false
  description: ""
  playbookInputQuery: null
- key: MD5
  value:
    simple: ${issue.initiatormd5}
  required: false
  description: ""
  playbookInputQuery: null
- key: SHA256
  value:
    simple: ${issue.initiatorsha256}
  required: false
  description: ""
  playbookInputQuery: null
- key: PID
  value:
    simple: ${issue.initiatorpid}
  required: false
  description: ""
  playbookInputQuery: null
- key: ProcessName
  value:
    simple: ${issue.xdmsourceprocessname}
  required: false
  description: ""
  playbookInputQuery: null
inputSections:
- inputs:
  - SourceIP
  - RemoteIP
  - UserName
  - EndpointID
  - HostName
  - Domain
  - MD5
  - SHA256
  - PID
  - ProcessName
  name: General (Inputs group)
  description: Generic group for inputs
outputSections:
- outputs:
  - SOCFramework.Artifacts.IP
  - SOCFramework.Artifacts.EndPointID
  - SOCFramework.Artifacts.UserName
  - SOCFramework.Artifacts.ProcessName
  - SOCFramework.Artifacts.File
  - SOCFramework.Artifacts.Verdict
  name: General (Outputs group)
  description: Generic group for outputs
outputs:
- contextPath: SOCFramework.Artifacts.IP
  type: unknown
- contextPath: SOCFramework.Artifacts.EndPointID
  type: unknown
- contextPath: SOCFramework.Artifacts.UserName
  type: unknown
- contextPath: SOCFramework.Artifacts.ProcessName
  type: unknown
- contextPath: SOCFramework.Artifacts.File
  type: unknown
- contextPath: SOCFramework.Artifacts.Verdict
  type: unknown
sourceplaybookid: Foundation - Enrichment_V3
dirtyInputs: true
adopted: true
