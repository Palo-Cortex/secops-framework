fromversion: 5.0.0
adopted: true
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    isoverridable: false
    itemVersion: 3.0.29
    packID: ""
    packName: SOC Framework Unified
    prevname: ""
    supportedModules: []
    toServerVersion: ""
description: |-
  This is the analyst’s core domain.

  Key tasks:

  Investigate alerts and anomalies.

  Validate true/false positives.

  Perform triage, correlation, and root cause analysis.

  Classify the alert (category, severity, impact).

  Document findings and escalate confirmed alerts.

  Outcome: Determine whether an event is a legitimate alert and assess its scope.

  This phase measures alert fidelity, investigation efficiency, and time to validate — all analyst performance metrics.
dirtyInputs: true
id: 'SOC EndPoint Analysis_V3'
inputSections:
- description: Generic group for inputs
  inputs:
  - SHA256
  - IPAddress
  - MessageID
  - ListernerMailbox
  - file_name
  - file_path
  - endpoint_id
  - alert_id
  - process_name
  - pid
  - verdict
  - user_name
  - entity_type
  - case_category
  name: General (Inputs group)
inputs:
- description: ""
  key: SHA256
  playbookInputQuery: null
  required: false
  value:
    simple: ${SOCFramework.Artifacts.File}
- description: ""
  key: IPAddress
  playbookInputQuery: null
  required: false
  value:
    simple: ${SOCFramework.Artifacts.IP}
- description: ""
  key: MessageID
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.emailmessageid}
- description: ""
  key: ListernerMailbox
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.xdmemailmailboxowner}
- description: ""
  key: file_name
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.filename}
- description: ""
  key: file_path
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.filepath}
- description: ""
  key: endpoint_id
  playbookInputQuery: null
  required: false
  value:
    simple: ${SOCFramework.Artifacts.EndPointID}
- description: ""
  key: alert_id
  playbookInputQuery: null
  required: false
  value:
    simple: ${issue.id}
- description: ""
  key: process_name
  playbookInputQuery: null
  required: false
  value:
    simple: ${SOCFramework.Artifacts.ProcessName}
- description: ""
  key: pid
  playbookInputQuery: null
  required: false
  value:
    simple: ${SOCFramework.Artifacts.PID}
- description: ""
  key: verdict
  playbookInputQuery: null
  required: false
  value:
    simple: ${SOCFramework.Artifacts.Verdict}
- description: ""
  key: user_name
  playbookInputQuery: null
  required: false
  value:
    simple: ${SOCFramework.Artifacts.UserName}
- description: ""
  key: entity_type
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: category
      root: SOCFramework.Product
      transformers:
      - operator: toLowerCase
- description: ""
  key: case_category
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: CategoryType
      root: SOCFramework.Artifacts
      transformers:
      - operator: toLowerCase
name: SOC EndPoint Analysis_V3
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs:
  - analysis.verdict
  - analysis.case_category
  - analysis.confidence
  - analysis.primary_entity_type
  - analysis.primary_entity_id
  - analysis.secondary_entities
  - analysis.response_recommended
  - analysis.notes
outputs:
- contextPath: analysis.verdict
  type: unknown
- contextPath: analysis.case_category
  type: unknown
- contextPath: analysis.confidence
  type: unknown
- contextPath: analysis.primary_entity_type
  type: unknown
- contextPath: analysis.primary_entity_id
  type: unknown
- contextPath: analysis.secondary_entities
  type: unknown
- contextPath: analysis.response_recommended
  type: unknown
- contextPath: analysis.notes
  type: unknown
sourceplaybookid: SOC Data Analysis_V3
starttaskid: "0"
tags:
- SOC
- SOC_Framework_Unified
- Detection & Analysis
- NIST 800-61
- EndPoint
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7e6a701e-667b-4a70-8a74-14564da75fc7
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: ""
      playbooktaskmissingcomponent: null
      version: -1
    taskid: 7e6a701e-667b-4a70-8a74-14564da75fc7
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -530,
          "y": 70
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6944e944-2ade-4f6d-b6e0-0f6b8e2c3253
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Done
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 6944e944-2ade-4f6d-b6e0-0f6b8e2c3253
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -220,
          "y": 2280
        }
      }
  "10":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: sourceBrand
                root: issue
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: traps
      label: XDR Agent
    - condition:
      - - left:
            iscontext: true
            value:
              simple: issue.originalalertsource
          operator: isEqualString
          right:
            value:
              simple: Microsoft Defender for Endpoint
      label: MS Defender
    - condition:
      - - left:
            iscontext: true
            value:
              simple: issue.tags
          operator: isEqualString
          right:
            value:
              simple: DS:CrowdStrike/Falcon_Event
      label: CrowdStrike
    - condition:
      - - left:
            iscontext: true
            value:
              simple: issue.tags
          operator: isEqualString
          right:
            value:
              simple: DS:Trend Micro Vision One V3
      label: Trend Micro
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      MS Defender:
      - "11"
      Trend Micro:
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e4f0079d-d9a1-496b-8830-e9436d7f984f
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Endpoint Agent?
      playbooktaskmissingcomponent: null
      type: condition
      version: -1
    taskid: e4f0079d-d9a1-496b-8830-e9436d7f984f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 550,
          "y": 400
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      IPAddress:
        simple: ${inputs.IPAddress}
      ListenerMailbox:
        simple: ${inputs.ListernerMailbox}
      MessageID:
        simple: ${inputs.MessageID}
      ResultsLimit:
        simple: "50"
      SHA256:
        simple: ${inputs.SHA256}
      SearchTimeframe:
        simple: "7"
      Timeout:
        simple: "180"
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |
        This playbook retrieves email data based on the `URLDomain`, `SHA256`, `IPAddress`. and `MessageID` inputs. The output is a unified object with all of the retrieved emails based on the following sub-playbooks outputs:

        - **Microsoft 365 Defender - Get Email URL clicks**:
                Retrieves data based on URL click events.


        - **Microsoft 365 Defender - Emails Indicators Hunt**:
                Retrieves data based on several different email events.

        Read the playbook's descriptions in order to get the full details.
      id: 080a811b-4797-4133-b3b2-540e5bb1efb4
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Microsoft 365 Defender - Threat Hunting Generic
      playbookId: Microsoft 365 Defender - Threat Hunting Generic
      playbooktaskmissingcomponent: null
      type: playbook
      version: -1
    taskid: 080a811b-4797-4133-b3b2-540e5bb1efb4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 640
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      id: b5188a48-89ce-4695-ae0f-1834c19c7bed
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: SOC Trend Micro Alert Enrichment
      playbookId: SOC Trend Micro Alert Enrichment
      playbookName: SOC Trend Micro Alert Enrichment
      playbooktaskmissingcomponent: null
      type: playbook
      version: -1
    taskid: b5188a48-89ce-4695-ae0f-1834c19c7bed
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 910,
          "y": 650
        }
      }
  "15":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.SHA256
          operator: isNotEmpty
      label: FILE
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "10"
      - "16"
      FILE:
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 69b517d8-a3b4-42a1-86e3-ac67d80b762c
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Artifact Is File?
      playbooktaskmissingcomponent: null
      type: condition
      version: -1
    taskid: 69b517d8-a3b4-42a1-86e3-ac67d80b762c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -530,
          "y": 220
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 667d3087-7a84-4449-a2b5-82483e404ed4
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Artifact is Process / Behavior
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 667d3087-7a84-4449-a2b5-82483e404ed4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1520,
          "y": 387.5
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a5347c9-1b51-4060-9103-6952be298b3e
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: File Verdict
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 4a5347c9-1b51-4060-9103-6952be298b3e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -530,
          "y": 530
        }
      }
  "19":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.verdict
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: malicious
      label: Malicious
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.verdict
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: suspicious
      label: Supicious
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.verdict
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: benign
      label: Benign
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      Benign:
      - "25"
      Malicious:
      - "21"
      Supicious:
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This pulls from the SOC Framework field that is set in the Upon
        Trigger from the Unit 42 Intelligence data context.
      id: cefda01d-1514-443f-8bf1-8d0bc6e9a9dc
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Unit 42 File Verdict
      playbooktaskmissingcomponent: null
      type: condition
      version: -1
    taskid: cefda01d-1514-443f-8bf1-8d0bc6e9a9dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -530,
          "y": 700
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 96b43e5e-3ad6-498c-98fe-406da228309d
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Artifact is FIle
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 96b43e5e-3ad6-498c-98fe-406da228309d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -530,
          "y": 387.5
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60e76198-1b19-4918-9492-86b16b2ba083
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Malcious
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 60e76198-1b19-4918-9492-86b16b2ba083
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1420,
          "y": 900
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8e4c5b5a-69ec-44c5-9277-c30466868862
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Supicious
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 8e4c5b5a-69ec-44c5-9277-c30466868862
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -980,
          "y": 900
        }
      }
  "23":
    continueonerror: true
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Analysis.verdict
      value:
        simple: malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 6ebe5b9f-4207-466c-9bf3-fb656b142cc3
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase Verdict
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 6ebe5b9f-4207-466c-9bf3-fb656b142cc3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1420,
          "y": 1050
        }
      }
  "24":
    continueonerror: true
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Analysis.verdict
      value:
        simple: supicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: d60ff05a-04d8-455c-8697-78b16442ce89
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase Verdict
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: d60ff05a-04d8-455c-8697-78b16442ce89
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1050
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 836a021d-4297-4663-9886-a99995717c56
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Benign
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 836a021d-4297-4663-9886-a99995717c56
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -550,
          "y": 900
        }
      }
  "26":
    continueonerror: true
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Analysis.verdict
      value:
        simple: benign
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: d7eb1278-d5aa-4dc4-902f-98ee124f7965
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase Verdict
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: d7eb1278-d5aa-4dc4-902f-98ee124f7965
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": 1050
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7042e9a9-6674-449e-86a9-1580dcb8e7ca
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Analysis Details
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 7042e9a9-6674-449e-86a9-1580dcb8e7ca
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1500
        }
      }
  "28":
    continueonerror: true
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Analysis.primary_entity_type
      value:
        complex:
          root: inputs.entity_type
          transformers:
          - operator: toLowerCase
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 8de3f341-2b1d-463a-b84d-bc21adca0ed3
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase Entity Type
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 8de3f341-2b1d-463a-b84d-bc21adca0ed3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1620
        }
      }
  "29":
    continueonerror: true
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Analysis.case_category
      value:
        simple: ${inputs.case_category}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 05b96653-8ad6-4a58-88ff-9eafb4a2ae1c
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase Category Type
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 05b96653-8ad6-4a58-88ff-9eafb4a2ae1c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1800
        }
      }
  "30":
    continueonerror: true
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Analysis.confidence
      value:
        simple: high
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 0fbc31cb-05e6-4ebd-b48c-b2f1b4b2f0ce
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase  Verdict Confidence
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 0fbc31cb-05e6-4ebd-b48c-b2f1b4b2f0ce
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1962.5
        }
      }
  "31":
    continueonerror: true
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Analysis.primary_entity_id
      value:
        simple: ${inputs.endpoint_id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 43b66a7a-e4ad-4cdb-8c51-c522e0c9c8ff
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase  Entity Type
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 43b66a7a-e4ad-4cdb-8c51-c522e0c9c8ff
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -980,
          "y": 2120
        }
      }
  "32":
    continueonerror: true
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: 'Analysis.response_recommended '
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: be9ece67-c525-42a5-b200-fdd2dadad478
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase  Response Recommended
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: be9ece67-c525-42a5-b200-fdd2dadad478
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1420,
          "y": 1300
        }
      }
  "33":
    continueonerror: true
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: 'Analysis.response_recommended '
      value:
        simple: "false"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: 0cbdfec7-90a8-4dac-86e3-c7b1ac90e84d
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase  Response Recommended
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 0cbdfec7-90a8-4dac-86e3-c7b1ac90e84d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -550,
          "y": 1300
        }
      }
  "34":
    continueonerror: true
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: 'Analysis.response_recommended '
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Set a value in context under the key you entered. If no value
        is entered, the script doesn't do anything.\n\nThis automation runs using
        the default Limited User role, unless you explicitly change the permissions.\nFor
        more information, see the section about permissions here:\n- For Cortex XSOAR
        6 see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex XSOAR 8 Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex XSOAR 8.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: da79252d-5ff2-436a-bfae-c4f9fe852810
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Set Analysis Phase  Response Recommended
      playbooktaskmissingcomponent: null
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: da79252d-5ff2-436a-bfae-c4f9fe852810
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1300
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f12a353f-5828-403c-8abd-adf7099d6492
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Action Required
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: f12a353f-5828-403c-8abd-adf7099d6492
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1420,
          "y": 1172.5
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0691f226-13d0-4cd7-9035-bed3061629f1
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Action Required
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 0691f226-13d0-4cd7-9035-bed3061629f1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -550,
          "y": 1180
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a968990-6563-4d01-9691-0bbf574dcbf2
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Action Required
      playbooktaskmissingcomponent: null
      type: title
      version: -1
    taskid: 4a968990-6563-4d01-9691-0bbf574dcbf2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -980,
          "y": 1180
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: Endpoint=${inputs.endpoint_id} PID=${inputs.pid}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: c9bc08b3-ae3b-4955-9f09-82a14fa08d6d
      iscommand: false
      istaskmissingcomponenterrordismissed: false
      name: Print PID
      playbooktaskmissingcomponent: null
      script: Print
      type: regular
      version: -1
    taskid: c9bc08b3-ae3b-4955-9f09-82a14fa08d6d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": 515
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "15_20_FILE": 0.89
    },
    "paper": {
      "dimensions": {
        "height": 2270,
        "width": 2810,
        "x": -1520,
        "y": 70
      }
    }
  }
